# The Gold Box v0.3.9 - Extras #2: Minor Issue Fixes

## Overview

This document outlines fixes for two minor issues identified during Feature 3 testing:
1. Remove deprecated maxMessageContext setting references
2. Add handler for settings_sync_response messages

---

## Issue 1: Remove Deprecated maxMessageContext Setting

### Problem
The code attempts to read a deprecated `maxMessageContext` setting that's no longer registered in `module.json`, causing repeated console errors:
```
SettingsManager: Error getting setting maxMessageContext: Error: "the-gold-box.maxMessageContext" is not a registered game setting
```

### Files Affected
- `scripts/services/message-collector.js`
- `scripts/api/backend-communicator.js`
- `scripts/gold-box.js`

### Solution
1. Remove all calls to `getSetting('maxMessageContext', 15)`
2. Replace with hardcoded default value of `15` where needed
3. Remove console.log statements referencing maxMessageContext setting
4. Update any code that tries to read from this deprecated setting

### Rationale
Since `maxMessageContext` is deprecated, the system should use the default value of 15 messages for context without attempting to read a non-existent setting.

---

## Issue 2: Add Handler for settings_sync_response

### Problem
WebSocket client receives `settings_sync_response` messages but has no handler, logging warnings:
```
websocket-client.js:245 Unknown message type: settings_sync_response
```

### File Affected
- `scripts/api/websocket-client.js` (line ~245 in handleMessage method)

### Solution
Add a case for `settings_sync_response` in the `handleMessage()` switch statement.

### Proposed Handler Code
```javascript
case 'settings_sync_response':
  console.log('WebSocket settings sync response received:', message.data);
  // Settings sync completed, no action needed
  break;
```

### Rationale
This message type is sent by the backend after settings are synced. The frontend should acknowledge it without generating a warning. Currently it falls through to the default case which logs it as "Unknown message type".

---

## Implementation Steps

1. **Remove maxMessageContext references**:
   - Update `scripts/services/message-collector.js`
   - Update `scripts/api/backend-communicator.js`
   - Update `scripts/gold-box.js`
   
2. **Add settings_sync_response handler**:
   - Update `scripts/api/websocket-client.js`

Both changes are minimal, non-breaking, and will clean up console warnings without affecting functionality.

---

## Expected Outcome

After implementation:
- ✅ No more "maxMessageContext is not a registered game setting" errors
- ✅ No more "Unknown message type: settings_sync_response" warnings
- ✅ Cleaner console output during operation
- ✅ No impact on existing functionality
